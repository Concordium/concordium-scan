{
  "db_name": "PostgreSQL",
  "query": "\n                    INSERT INTO metrics_plt_transfer (\n                        event_timestamp, \n                        token_index,\n                        cumulative_transfer_count,\n                        cumulative_transfer_amount\n                    )\n                    SELECT \n                        $1,\n                        (SELECT index FROM plt_tokens WHERE token_id = $2),\n                        COALESCE((SELECT cumulative_transfer_count FROM metrics_plt_transfer WHERE token_index = (SELECT index FROM plt_tokens WHERE token_id = $2) ORDER BY event_timestamp DESC LIMIT 1), 0) + 1,\n                        COALESCE((SELECT cumulative_transfer_amount FROM metrics_plt_transfer WHERE token_index = (SELECT index FROM plt_tokens WHERE token_id = $2) ORDER BY event_timestamp DESC LIMIT 1), 0) + $3\n                    ON CONFLICT (event_timestamp, token_index) DO UPDATE SET\n                        cumulative_transfer_count = GREATEST(metrics_plt_transfer.cumulative_transfer_count, EXCLUDED.cumulative_transfer_count),\n                        cumulative_transfer_amount = GREATEST(metrics_plt_transfer.cumulative_transfer_amount, EXCLUDED.cumulative_transfer_amount)\n                    ",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Timestamptz",
        "Text",
        "Numeric"
      ]
    },
    "nullable": []
  },
  "hash": "c7f0d3a343317debe5d92ff674934cfa6cf366d17fd7ccca5b051526ae283a8f"
}
