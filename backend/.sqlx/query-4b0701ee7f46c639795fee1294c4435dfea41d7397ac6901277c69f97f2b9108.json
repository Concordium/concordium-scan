{
  "db_name": "PostgreSQL",
  "query": "WITH \n                acc AS (\n                    SELECT index AS account_index FROM accounts WHERE address = $1\n                ),\n                tok AS (\n                    SELECT index AS token_index, decimal FROM plt_tokens WHERE token_id = $2\n                ),\n                upsert_token AS (\n                    INSERT INTO plt_accounts (account_index, token_index, amount, decimal)\n                    SELECT acc.account_index, tok.token_index, $3, tok.decimal\n                    FROM acc, tok\n                    ON CONFLICT (account_index, token_index) DO UPDATE\n                    SET amount = plt_accounts.amount + $3\n                    RETURNING account_index\n                )\n                INSERT INTO plt_accounts_sum_amounts (account_index, total_amount)\n                SELECT acc.account_index, $3 FROM acc\n                ON CONFLICT (account_index) DO UPDATE\n                SET total_amount = plt_accounts_sum_amounts.total_amount + EXCLUDED.total_amount;\n                ",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Text",
        "Text",
        "Numeric"
      ]
    },
    "nullable": []
  },
  "hash": "4b0701ee7f46c639795fee1294c4435dfea41d7397ac6901277c69f97f2b9108"
}
