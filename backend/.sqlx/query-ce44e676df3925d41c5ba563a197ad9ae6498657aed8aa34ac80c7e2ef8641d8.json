{
  "db_name": "PostgreSQL",
  "query": "WITH updated_accounts AS (\n                INSERT INTO plt_accounts (account_index, token_index, amount, decimal)\n                VALUES\n                    ( (SELECT index FROM accounts WHERE address = $1),\n                    (SELECT index FROM plt_tokens WHERE token_id = $3),\n                    -$4::numeric,\n                    (SELECT decimal FROM plt_tokens WHERE token_id = $3)\n                    ),\n                    ( (SELECT index FROM accounts WHERE address = $2),\n                    (SELECT index FROM plt_tokens WHERE token_id = $3),\n                    $4::numeric,\n                    (SELECT decimal FROM plt_tokens WHERE token_id = $3)\n                    )\n                ON CONFLICT (account_index, token_index) DO UPDATE\n                SET amount = plt_accounts.amount + EXCLUDED.amount\n                RETURNING account_index\n            )\n            INSERT INTO plt_accounts_sum_amounts (account_index, total_amount)\n            VALUES\n                ( (SELECT index FROM accounts WHERE address = $1), -$4::numeric ),\n                ( (SELECT index FROM accounts WHERE address = $2),  $4::numeric )\n            ON CONFLICT (account_index) DO UPDATE\n            SET total_amount = plt_accounts_sum_amounts.total_amount + EXCLUDED.total_amount;\n            ",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Text",
        "Text",
        "Text",
        "Numeric"
      ]
    },
    "nullable": []
  },
  "hash": "ce44e676df3925d41c5ba563a197ad9ae6498657aed8aa34ac80c7e2ef8641d8"
}
